<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Crop Yield Predictor</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>

  <body>
    <div class="container my-5">
      <h1 class="text-center text-success mb-5">
        ðŸŒ¾ Crop Yield Prediction by Country
      </h1>

      <div class="card-style mx-auto" style="max-width: 700px">
        <h2 class="text-center text-dark mb-4">Enter Agricultural Data</h2>

        <form action="/predict" method="post">
          <div class="mb-3">
            <label for="Year" class="form-label">Year</label>
            <input
              type="number"
              class="form-control"
              name="Year"
              step="1"
              value="2013"
              required
            />
          </div>

          <div class="mb-3">
            <label for="average_rain_fall_mm_per_year" class="form-label"
              >Average Rainfall (mm/year)</label
            >
            <input
              type="number"
              class="form-control"
              name="average_rain_fall_mm_per_year"
              step="any"
              placeholder="e.g., 1200"
              required
            />
          </div>

          <div class="mb-3">
            <label for="pesticides_tonnes" class="form-label"
              >Pesticides Used (tonnes)</label
            >
            <input
              type="number"
              class="form-control"
              name="pesticides_tonnes"
              step="any"
              placeholder="e.g., 140"
              required
            />
          </div>

          <div class="mb-3">
            <label for="avg_temp" class="form-label"
              >Average Temperature (Â°C)</label
            >
            <input
              type="number"
              class="form-control"
              name="avg_temp"
              step="any"
              placeholder="e.g., 32"
              required
            />
          </div>

          <div class="mb-3">
            <label for="Area" class="form-label">Area (Country)</label>
            <input
              list="area-list"
              class="form-control"
              name="Area"
              placeholder="e.g., India"
              required
            />
            <datalist id="area-list">
              {% for area in areas %}
              <option value="{{ area }}"></option>
              {% endfor %}
            </datalist>
          </div>

          <div class="mb-4">
            <label for="Item" class="form-label">Crop</label>
            <input
              list="item-list"
              class="form-control"
              name="Item"
              placeholder="e.g., Wheat"
              required
            />
            <datalist id="item-list">
              {% for item in items %}
              <option value="{{ item }}"></option>
              {% endfor %}
            </datalist>
          </div>

          <div class="text-center">
            <button type="submit" class="btn btn-custom">Predict Yield</button>
          </div>
        </form>

        {% if prediction %}
        <div class="result-box mt-4 text-center">
          <h4 class="text-success">Predicted Yield</h4>
          <h2>{{ prediction }} <small class="text-muted">hg/ha</small></h2>
        </div>
        {% endif %}
      </div>

      {% if years and yields %}
      <div id="chart-container" class="mt-5">
        <canvas id="yieldChart" width="100%" height="40"></canvas>
      </div>
      {% endif %}
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom Chart Logic -->
    <script src="{{ url_for('static', filename='js/yield_chart.js') }}"></script>

    {% if years and yields %}
    <script>
      const labels = {{ years | tojson }};
      const data = {{ yields | tojson }};
      const item = "{{ selected_item }}";
      const area = "{{ selected_area }}";

      renderYieldChart(labels, data, item, area);
    </script>
    {% endif %}
  </body>
</html>
